{
  "name": "speed_tests_models_api_openrouter",
  "nodes": [
    {
      "id": "manualTrigger",
      "name": "Когда запускается вручную",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [-800, 0]
    },
    {
      "id": "getRows",
      "name": "Get Rows in Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [-600, 0],
      "credentials": {
        "googleSheetsOAuth2Api": "Google Sheets account"
      },
      "parameters": {
        "operation": "getAll",
        "documentId": "1c3AV_9b8VcrLws0GkRb0EP8LjUqMCYnyxBsKNujzqyM",
        "sheetName": "Sheet1",
        "returnAll": true
      }
    },
    {
      "id": "splitBatches",
      "name": "Split In Batches",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [-400, 0],
      "parameters": {
        "batchSize": 1
      }
    },
    {
      "id": "dateTimeStart",
      "name": "Date & Time Start",
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 3,
      "position": [-200, -100],
      "parameters": {
        "operation": "getCurrentDate",
        "includeTime": true,
        "outputField": "start_time"
      }
    },
    {
      "id": "httpRequest",
      "name": "HTTP Request",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [0, -100],
      "credentials": {
        "httpHeaderAuth": "openrouterApi"
      },
      "parameters": {
        "method": "POST",
        "url": "https://openrouter.ai/api/v1/chat/completions",
        "jsonParameters": true,
        "jsonBody": {
          "model": "={{$json[\"Название модели\"]}}",
          "messages": [
            {
              "role": "system",
              "content": "Ты полезный помощник."
            },
            {
              "role": "user",
              "content": "Привет, как дела?"
            }
          ],
          "max_tokens": 3000,
          "temperature": 0.7,
          "stream": false
        }
      }
    },
    {
      "id": "dateTimeEnd",
      "name": "Date & Time End",
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 3,
      "position": [200, -100],
      "parameters": {
        "operation": "getCurrentDate",
        "includeTime": true,
        "outputField": "end_time"
      }
    },
    {
      "id": "getDuration",
      "name": "Get Duration",
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 3,
      "position": [400, -100],
      "parameters": {
        "operation": "getTimeBetweenDates",
        "startDate": "={{$json.start_time}}",
        "endDate": "={{$json.end_time}}",
        "units": ["seconds"],
        "outputField": "duration"
      }
    },
    {
      "id": "setFields",
      "name": "Set Fields",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [600, 0],
      "parameters": {
        "mode": "manual",
        "values": {
          "Время отправки HTTP запроса": "={{$json.start_time}}",
          "Время получения HTTP запроса": "={{$json.end_time}}",
          "Сколько по времени обрабатывался": "={{$json.duration}} сек",
          "Текст полученного сообщения": "={{$node[\"HTTP Request\"].json.choices[0].message.content}}"
        }
      }
    },
    {
      "id": "updateRow",
      "name": "Update Sheet Row",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [800, 0],
      "credentials": {
        "googleSheetsOAuth2Api": "Google Sheets account"
      },
      "parameters": {
        "operation": "update",
        "documentId": "1c3AV_9b8VcrLws0GkRb0EP8LjUqMCYnyxBsKNujzqyM",
        "sheetName": "Sheet1",
        "columns": {
          "Время отправки HTTP запроса": "={{$json[\"Время отправки HTTP запроса\"]}}",
          "Время получения HTTP запроса": "={{$json[\"Время получения HTTP запроса\"]}}",
          "Сколько по времени обрабатывался": "={{$json[\"Сколько по времени обрабатывался\"]}}",
          "Текст полученного сообщения": "={{$json[\"Текст полученного сообщения\"]}}"
        },
        "matchingColumns": ["row_number"]
      }
    },
    {
      "id": "waitBetween",
      "name": "Wait Between Requests",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1,
      "position": [1000, 0],
      "parameters": {
        "unit": "seconds",
        "time": 1
      }
    }
  ],
  "connections": {
    "manualTrigger": {
      "main": [
        [
          {
            "node": "getRows",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "getRows": {
      "main": [
        [
          {
            "node": "splitBatches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "splitBatches": {
      "main": [
        [
          {
            "node": "dateTimeStart",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "dateTimeStart": {
      "main": [
        [
          {
            "node": "httpRequest",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "httpRequest": {
      "main": [
        [
          {
            "node": "dateTimeEnd",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "dateTimeEnd": {
      "main": [
        [
          {
            "node": "getDuration",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "getDuration": {
      "main": [
        [
          {
            "node": "setFields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "setFields": {
      "main": [
        [
          {
            "node": "updateRow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "updateRow": {
      "main": [
        [
          {
            "node": "waitBetween",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "waitBetween": {
      "main": [
        [
          {
            "node": "splitBatches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  }
}
